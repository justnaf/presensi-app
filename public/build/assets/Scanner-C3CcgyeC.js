import{d as b,r as u,i as w,z as C,s as S,a as r,o as n,b as i,u as d,g as E,w as y,e as t,k as j,F as h,f as M,t as m,v as B,A as q,h as A,B as F}from"./app-Dp3atsk-.js";import{_ as P}from"./AppLayout.vue_vue_type_script_setup_true_lang-D0ggPK06.js";import{H as U}from"./html5-qrcode-scanner-mVfWwMBH.js";import{C as V}from"./circle-check-big-qg1P5E18.js";import{C as z}from"./circle-x-CmWjCiB9.js";import{c as D}from"./createLucideIcon-CoASaL8M.js";import{U as H}from"./users-DeRswxfd.js";import"./index-CoVeNWSk.js";import"./useForwardExpose-CWi2vH9b.js";import"./RovingFocusGroup-JD4vvLnv.js";import"./x-DylLKXAE.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Ds_4e0_t.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-5Gfxvp6R.js";import"./user-BQ3HY7ta.js";import"./qr-code-CrQt9mnG.js";import"./scan-line-C-pItM7a.js";import"./calendar-days-CkzV-Xaa.js";import"./ticket-C0WPd6e6.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=D("CameraOffIcon",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16",key:"qmtpty"}],["path",{d:"M9.5 4h5L17 7h3a2 2 0 0 1 2 2v7.5",key:"1ufyfc"}],["path",{d:"M14.121 15.121A3 3 0 1 1 9.88 10.88",key:"11zox6"}]]),K={class:"py-12"},L={class:"mx-auto max-w-xl sm:px-6 lg:px-8"},N={class:"overflow-hidden bg-white p-6 text-center shadow-sm sm:rounded-lg dark:bg-gray-800"},T={class:"mx-auto my-6 max-w-sm"},O=["value"],Q={key:0},R={class:"mt-6 min-h-[80px]"},X={key:0,class:"flex flex-col items-center justify-center text-green-500"},$={class:"mt-2 font-bold"},G={class:"text-lg text-gray-800 dark:text-gray-200"},J={key:1,class:"flex flex-col items-center justify-center text-red-500"},W={class:"mt-2 font-bold"},Y={key:0,class:"text-lg text-gray-800 dark:text-gray-200"},Z={key:2,class:"flex flex-col items-center justify-center text-gray-400"},ee={key:1,class:"mt-8 flex flex-col items-center justify-center rounded-lg border-2 border-dashed border-gray-300 p-12 text-center dark:border-gray-600"},ke=b({__name:"Scanner",props:{events:{}},setup(te){const c=u(null),o=u(null),s=u({success:!1,error:!1,message:"",name:""}),f=u(!1),k=()=>{o.value&&o.value.clear().catch(e=>console.error("Error clearing scanner:",e));const l=e=>{f.value||!c.value||(f.value=!0,F.post(route("admin.events.scan",c.value.id),{ticket_code:e}).then(a=>{s.value={success:!0,error:!1,message:a.data.message,name:a.data.attendee_name}}).catch(a=>{var v,p,x,g;s.value={success:!1,error:!0,message:((p=(v=a.response)==null?void 0:v.data)==null?void 0:p.message)||"Error",name:((g=(x=a.response)==null?void 0:x.data)==null?void 0:g.attendee_name)||""}}).finally(()=>{setTimeout(()=>{f.value=!1,s.value={success:!1,error:!1,message:"",name:""}},3e3)}))};try{const e=new U("qr-reader",{fps:10,qrbox:{width:250,height:250}},!1);e.render(l,()=>{}),o.value=e}catch(e){console.error("Failed to initialize scanner:",e)}};w(c,l=>{l?C(()=>{k()}):o.value&&(o.value.clear().catch(e=>console.error("Error clearing scanner on deselect:",e)),o.value=null)}),S(()=>{o.value&&o.value.clear().catch(l=>{console.error("Failed to clear scanner on unmount.",l)})});const _=[{title:"Manajemen Event",href:route("admin.events.index")},{title:"Scanner Kehadiran",href:"#"}];return(l,e)=>(n(),r(h,null,[i(d(E),{title:"Scanner Kehadiran"}),i(P,{breadcrumbs:_},{default:y(()=>[t("div",K,[t("div",L,[t("div",N,[e[7]||(e[7]=t("h2",{class:"text-2xl font-bold text-gray-800 dark:text-gray-200"},"Scanner Absensi",-1)),t("div",T,[e[2]||(e[2]=t("label",{for:"event-select",class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"},"Pilih Event untuk Dipindai",-1)),j(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>c.value=a),id:"event-select",class:"block w-full rounded-md border-gray-300 p-2 text-gray-900 shadow-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300"},[e[1]||(e[1]=t("option",{value:null},"-- Silakan Pilih Event --",-1)),(n(!0),r(h,null,M(l.events,a=>(n(),r("option",{key:a.id,value:a},m(a.name),9,O))),128))],512),[[B,c.value]])]),c.value?(n(),r("div",Q,[e[4]||(e[4]=t("div",{id:"qr-reader",class:"mx-auto w-full max-w-sm rounded-lg border-2 border-gray-300 dark:border-gray-600"},null,-1)),t("div",R,[i(q,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100"},{default:y(()=>[s.value.success?(n(),r("div",X,[i(d(V),{class:"h-12 w-12"}),t("p",$,m(s.value.message),1),t("p",G,m(s.value.name),1)])):s.value.error?(n(),r("div",J,[i(d(z),{class:"h-12 w-12"}),t("p",W,m(s.value.message),1),s.value.name?(n(),r("p",Y,m(s.value.name),1)):A("",!0)])):(n(),r("div",Z,[i(d(I),{class:"h-12 w-12"}),e[3]||(e[3]=t("p",{class:"mt-2 text-sm"},"Arahkan kamera ke QR Code tiket",-1))]))]),_:1})])])):(n(),r("div",ee,[i(d(H),{class:"h-16 w-16 text-gray-400"}),e[5]||(e[5]=t("h3",{class:"mt-2 text-lg font-medium text-gray-900 dark:text-gray-100"},"Pilih Event untuk Memulai",-1)),e[6]||(e[6]=t("p",{class:"mt-1 text-sm text-gray-500"},"Kamera pemindai akan aktif setelah event dipilih.",-1))]))])])])]),_:1})],64))}});export{ke as default};
