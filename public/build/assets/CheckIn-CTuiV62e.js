import{d as j,p as C,c as b,r as p,x as K,q as S,a as i,o as n,b as m,e as t,u as a,g as B,h as r,j as y,t as l,n as V,y as z,k as h,m as N,v as E,F as f,f as F}from"./app-ncV-sHbs.js";import{u as U}from"./useSweetAlert-Cof9YfZk.js";import{c as x}from"./createLucideIcon-CHH8bpeK.js";import{U as D}from"./user-CosGE7DE.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=x("BuildingIcon",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=x("LocateFixedIcon",[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=x("LogInIcon",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),G={class:"flex min-h-screen items-center justify-center bg-gray-100 p-4 font-sans dark:bg-gray-900"},P={class:"w-full max-w-md"},Q={class:"space-y-6 rounded-2xl bg-white p-8 shadow-2xl dark:bg-gray-800"},$={class:"text-center"},H={class:"mt-1 text-gray-600 dark:text-gray-400"},J={class:"font-semibold"},R={key:0,class:"flex items-center justify-center gap-2"},W={key:1},X={key:2,class:"mt-1"},Y={key:3,class:"mt-1"},Z={key:0,class:"rounded-lg bg-indigo-50 p-4 text-center dark:bg-indigo-900/50"},ee={class:"text-lg font-semibold text-indigo-900 dark:text-indigo-200"},te={key:0,class:"space-y-4"},se={for:"name",class:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300"},ae={key:0,class:"mt-2 text-sm text-red-500"},ie={for:"institution_id",class:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300"},ne=["value"],oe={key:0,class:"mt-2 text-sm text-red-500"},re=["disabled"],ge=j({__name:"CheckIn",props:{event:{},staticQr:{},institutions:{},auth:{},errors:{}},setup(_){const v=_,w=C(),{error:M}=U(),k=b(()=>w.props.auth.user),g=p(!k.value),s=K({name:"",is_guest:g.value,code:v.staticQr.code,event_id:v.event.id,institution_id:null,latitude:null,longitude:null}),I=()=>{s.is_guest=g.value,s.post(route("public.checkin.process"),{preserveScroll:!0,onError:d=>{if(Object.keys(d).length>0){const e=Object.values(d)[0];M(e||"Terdapat kesalahan pada input Anda. Silakan periksa kembali.")}}})},u=p(!0),c=p(null),L=()=>{if(!navigator.geolocation){c.value="Geolocation tidak didukung oleh browser Anda.",u.value=!1;return}u.value=!0,c.value=null,navigator.geolocation.getCurrentPosition(d=>{s.latitude=d.coords.latitude,s.longitude=d.coords.longitude,u.value=!1},()=>{c.value="Izin lokasi ditolak. Aktifkan untuk melanjutkan.",u.value=!1})};S(()=>{L()});const A=b(()=>s.processing||u.value||!!c.value);return(d,e)=>(n(),i(f,null,[m(a(B),{title:"Konfirmasi Kehadiran"}),t("div",G,[t("div",P,[t("div",Q,[t("div",$,[e[5]||(e[5]=t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},"Konfirmasi Kehadiran",-1)),t("p",H,[e[4]||(e[4]=y(" untuk event: ")),t("span",J,l(d.event.name),1)])]),t("div",{class:V(["rounded-lg p-3 text-center text-sm",{"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300":u.value,"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300":c.value}])},[u.value?(n(),i("p",R,[m(a(T),{class:"h-4 w-4 animate-pulse"}),e[6]||(e[6]=y(" Mencari lokasi Anda... "))])):r("",!0),c.value?(n(),i("p",W,l(c.value),1)):r("",!0),a(s).errors.latitude?(n(),i("p",X,l(a(s).errors.latitude),1)):r("",!0),a(s).errors.longitude?(n(),i("p",Y,l(a(s).errors.longitude),1)):r("",!0)],2),k.value&&!g.value?(n(),i("div",Z,[e[7]||(e[7]=t("p",{class:"text-sm text-indigo-800 dark:text-indigo-300"},"Anda akan check-in sebagai:",-1)),t("p",ee,l(k.value.name),1),t("button",{onClick:e[0]||(e[0]=o=>g.value=!0),class:"mt-2 text-xs text-indigo-600 hover:underline dark:text-indigo-400"}," Bukan Anda? Check-in sebagai tamu. ")])):r("",!0),t("form",{onSubmit:z(I,["prevent"]),class:"space-y-6"},[g.value?(n(),i("div",te,[t("div",null,[t("label",se,[m(a(D),{class:"h-4 w-4"}),e[8]||(e[8]=y("Nama Lengkap"))]),h(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>a(s).name=o),id:"name",type:"text",required:"",class:"mt-1 block w-full rounded-md border-gray-300 p-2 text-gray-900 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300",placeholder:"Masukkan nama Anda"},null,512),[[N,a(s).name]]),a(s).errors.name?(n(),i("p",ae,l(a(s).errors.name),1)):r("",!0)]),t("div",null,[t("label",ie,[m(a(O),{class:"h-4 w-4"}),e[9]||(e[9]=y("Asal Instansi/Lembaga"))]),h(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>a(s).institution_id=o),id:"institution_id",class:"mt-1 block w-full rounded-md border-gray-300 p-2 text-gray-900 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300"},[e[10]||(e[10]=t("option",{value:null},"-- Pilih Instansi (Opsional) --",-1)),(n(!0),i(f,null,F(d.institutions,o=>(n(),i("option",{key:o.id,value:o.id},l(o.name),9,ne))),128))],512),[[E,a(s).institution_id]]),a(s).errors.institution_id?(n(),i("p",oe,l(a(s).errors.institution_id),1)):r("",!0)]),k.value?(n(),i("button",{key:0,onClick:e[3]||(e[3]=o=>g.value=!1),class:"mt-2 text-xs text-indigo-600 hover:underline dark:text-indigo-400"}," Kembali untuk check-in sebagai "+l(k.value.name)+". ",1)):r("",!0)])):r("",!0),t("div",null,[t("button",{type:"submit",disabled:A.value,class:"flex w-full items-center justify-center gap-2 rounded-lg bg-indigo-600 px-3 py-3 text-sm font-semibold text-white shadow-sm transition hover:bg-indigo-500 disabled:cursor-not-allowed disabled:bg-indigo-400 dark:disabled:bg-indigo-800"},[m(a(q),{class:"h-5 w-5"}),e[11]||(e[11]=y(" Konfirmasi Kehadiran "))],8,re)])],32)])])])],64))}});export{ge as default};
